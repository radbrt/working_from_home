---
title: "Exploring remote work from job ads"
author: "Henning Holgersen"
date: "2020-04-07"
output:
  
  html_document: default
  #pdf_document: default
bibliography: refs.bib
---

```{r setup, include=FALSE}

# install.packages(c("gt", "arrow"))

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message=FALSE)
options(scipen=999, big.mark=" ", digits=1)


knitr::knit_hooks$set(inline = function(x) {
prettyNum(x, big.mark=" ", decimal.mark=",", digits=1)
})


library(tidyverse)
library(broom)
library(arrow)
library(gt)
library(sf)

# Labels for 1-digit ISCO
isco_labels <- c('0'='Armed forces and unspecified', 
           '1'='Managers', 
           '2'='Academics', 
           '3'='Technicians and associate professionals', 
           '4'='clerical support workers',
           '5'= 'Service and sales workers',
           '6'='Skilled agricultural, forestry and fishery workers',
           '7'='Craft and related trades workers',
           '8'='Plant and machine operators and assemblers',
           '9'='Elementary Occupations')


# ads <- read_parquet('data/stillinger_all_merged_isco08.parquet')
# 
# 
# ads %>% 
#   mutate(wfh = grepl("hjemmekontor|heimekontor", stillingsbeskrivelse_vasket, ignore.case=T )) %>% 
#   select(isco_versjon, yrkeskode, yrke, wfh, arbeidssted_kommunenummer, statistikk_aar_mnd, bedrift_naring_primar_kode) -> wfh
# 
# save(wfh, file='wfh.RData')
# save(ads, file='ads.RData')
# 
# load('ads.RData')
 load('wfh.RData')

```


## Abstract
The COVID-19 pandemic has forced great societal changes, including forcing many to work remotely (work from home) in an effort to increase social distancing. The ability to work from home has long been considered a perk, but only a few surveys have covered this. We demonstrate two alternative approaches to estimating the opportunities of working remotely, and compare the results with existing survey data.



## Introduction

The COVID-19 pandemic has propelled the question of working from home into the spotlight, as a matter of enforcing social distancing. The crisis has forced us to learn more about what possibilities for working remotely already exists, including questions about what percentage of the workforce are able to work from home, and what types of jobs can be done from home.

In 2018, the norwegian LFS in  asked respondents if they were able and allowed to work from home at times. After the pandemic outbreak, at least one [TODO: REF] survey has employees about their new work situation with respect to working from home.

Social media has been quick to argue that the people who are able to work at home are already privilidged, highly educated and highly paid, while those who still have to go to work are more often in low-paid but critical roles such as drivers and grocers.

In an alternative approach focusing on existing occupation classifications, we estimate the share of the norwegian workforce able to work remotely by combining register-based labor statistics, annotated job advertisements, and the official documentation of the ISCO-08 standard which is used both in labor statistics and in the job ads. Most of the data about the norwegian workforce is based on register data, and the information we have about what people do at work are based on occupational codes following the ISCO standard. Labor statistics are currently published following the ISCO-08 standard [@ISCO:08].

ISCO-08 is a taxonomy aimed at classifying jobs into "occupations", which are relatable to the reader. These occupations do not say directly wether the job can be performed from home. By evaluating the ISCO-08 documentation, we are able to categorize each occupation as likely or unlikely to be remote-friendly. This classification is evaluated against job ads published by the norwegian welfare administration (NAV) between january 2012 and march 2019, in which there are mentions of remote possibilities.

We find that approximately 34% of norwegian jobs can be performed from home.

## Methodology

In order annotate the ISCO-08 documentation and provide a assertion of wether each occupation is likely able to be performed from home, we created a public labeling job through Amazon Mechanical Turk [@MT]. Each occupation was presented together with a brief description, and the respondent was asked to evaluate wether it was likely that the job could be performed from a private home for a period of up to two weeks. We consider that two weeks is enough to argue that the job can *mainly* be performed from home. Two weeks is an arbitrary line to draw, but the neuances of this timeframe is unlikely to have any significant effect on the result.

The exact question formulation was "Can this type of job likely be performed from a home office?", and an example of a job description could be:

> Social work and counselling professionals provide advice and guidance to individuals, families, groups, communities and organizations in response to social and personal difficulties.  They assist clients to develop skills and access resources and support services needed to respond to issues arising from unemployment, poverty, disability, addiction, criminal and delinquent behaviour, marital and other problems.

The alternatives were "Yes", "No" and "Unknown", which were provided with the following description: 
- Yes: This job can be performed primarily from an office in a private home
- No: Substatantial parts of this job must be performed outside the employees home
- Unknown: There is not enough information to decide

The last option, "Unknown" was added in order to reduce arbitrary responses to uninformative occupation descriptions.

Since the job was on Mechanical Turk, there respondents are not subject matter experts, and likely reside in different countries. This adds to the importance of obtaining more than one label per occupation, but the number of labels does not correct for possible cultural differences - it is possible that some jobs that cannot be performed remotely in other countries can be performed remotely in Norway. We should consider the annotations as "international", which is also true for the ISCO-08 standard itself.

In order to evaluate the annotations from Mechanical Turk, we use job ads from the norwegian welfare administration. Since the possibility to work from home is a perk for many, some employers mention it in their job ads in order to attract candidates. We search the texts for mentions of "hjemmekontor" and "heimekontor", two distinctive words unlikely to mean anything other than the possibility of working from home. Since far from every employer advertise this possibility, it is difficult to say anything about the total number of remote-friendly jobs from these ads. It does however say something important about the relative frequency of remote-friendly jobs across broader occupational groups, which we can use to validate the results from Mechanical Turk.


## Results

### Total remote-percentage

```{r, include=FALSE}

annotations <- read_parquet('data/mt_data.parquet') %>% 
  mutate(wfh_dummy = as.numeric(wfh_dummy))
syss <- read_parquet('data/syss.parquet')
names(syss) <- c('ISCO', 'antall')

syss %>% 
  mutate(antall = as.numeric(antall)) -> syss

# Manual check of non-matches reveal similar distribution, impute mean (=inner_join) works OK.
syss %>%
  mutate(ISCO = trimws(ISCO)) %>% 
  inner_join(annotations, on='ISCO') %>%
  mutate(remote_count = wfh_dummy*antall) -> syss_total


```


From the Mechanical Turk annotations we see that `r prettyNum(100*mean(annotations$wfh_dummy))` per cent of the occupations can likely be performed from home. Taken together with the labor statistics per occupation, we find that `r prettyNum(sum(syss_total$remote_count))` occupations, `r prettyNum(100*sum(syss_total$remote_count)/sum(syss_total$antall) )` per cent of the workforce, are likely able to work from home.

### Validating results against job-ads

The job ads can not be compared directly to the annotated ISCO-08 data, but one of the comparisons we are able to do is the relative frequency of remote possibilities across broader occupational groups. Some job ads mention remote work, and we can expect that remote possibilities are mentioned more often within groups where remote possibilities are an option. We can compare this frequency with the number of remote-friendly occupations within each broader group. We also compute the composition of remote-friendly jobs across the occupational groups, giving us a measure that is directly comparable.


```{r}


wfh %>%
  #filter(statistikk_aar_mnd>'2017') %>%
  mutate(ISCO1 = substr(yrkeskode,1 ,1)) %>%
  group_by(ISCO1) %>%
  summarize(wfh_prob = mean(wfh), number_of_ads=n(), number_of_mentions=sum(wfh)) %>%
  ungroup() %>%
  mutate(relative_prob_ads = number_of_mentions/(sum(number_of_mentions))) -> ads_st1_stats


annotations %>%
  mutate(ISCO1 = substr(ISCO,1 ,1)) %>%
  group_by(ISCO1) %>%
  summarize(wfh_prob = mean(wfh_dummy), number_of_ads=n(), number_of_mentions=sum(wfh_dummy)) %>%
  ungroup() %>%
  mutate(relative_prob_annotations = number_of_mentions/(sum(number_of_mentions))) -> annotations_st1_stats


ads_st1_stats %>%
  inner_join(annotations_st1_stats, by='ISCO1') %>%
  select(ISCO1, relative_prob_annotations, relative_prob_ads) %>%
  mutate(pctpts_diff = relative_prob_annotations-relative_prob_ads,
         ISCO1=isco_labels[ISCO1])  -> ads_st1_table

ads_st1_table %>% 
  gt() %>%
  tab_header("Relative frequency of remote-possibilities across ISCO groups") %>%
  fmt_percent(columns = vars(relative_prob_annotations, relative_prob_ads, pctpts_diff), decimals = 1, dec_mark = ",") %>%
  cols_label(ISCO1 = 'Occupational group',
             relative_prob_annotations = "Annotations",
             relative_prob_ads = "Job ads",
             pctpts_diff = "Difference") %>%
  tab_spanner(
    columns = vars(relative_prob_annotations, relative_prob_ads),
    label="Relative remote frequency"
  ) %>%
  summary_rows(
    columns = vars(relative_prob_annotations, relative_prob_ads),
    fns = list(Sum = ~ sum(.)),
    formatter = fmt_percent
  )


```

The noteable discrepancies for the groups "Service and sales workers" and "Clearical support workers" have a strange symmetry. These two groups share a lot of similarities, but one of the differentiators are that sales jobs are explicitly customer facing, while clerical support workers typically work in a backoffice position. Intuitively this would suggest that somehow the annotations are correct while the job ads are incorrect, but many explanations exist.



The correlation between the two measures are strong, but in order to evaluate it statistically we would benefit from more detailed data. One approach is to use a logistic regression explaining the annotation of an occupation (a binary label) with the ratio of mentions of "hjemmekontor" in the ad.


```{r}

wfh %>%
  group_by(yrkeskode) %>%
  summarize(wfh_prob = mean(wfh), number_of_ads=n(), number_of_mentions=sum(wfh)) %>%
  ungroup() %>%
  mutate(relative_prob_ads = number_of_mentions/(sum(number_of_mentions))) -> ads_yrke


annotations %>%
  inner_join(ads_yrke, by=c("ISCO"="yrkeskode")) -> ads_annotated

names(ads_annotated)


m <- glm(wfh_dummy ~ wfh_prob, data=ads_annotated, family = "binomial" )

tidy(m) %>%
  gt() %>% 
  fmt_number(columns = vars(p.value), decimals = 4)
  

```

Menitoning "hjemmekontor" in the add is significantly correlated with the annotation, if only within an inch of the usual 5 % significance threshold. 

Given the spuriousness of the data sources, the results seem fairly well aligned.


### Analyzing the remote occupations

Splitting the annotated data into occupational groups, we can see what percentage of occupations are remote-friendly across occupational groups:

```{r}

syss_total %>% 
  group_by(ISCO1) %>% 
  summarize(antall = sum(antall),
            remote_antall = sum(remote_count),
    remote_pct = sum(remote_count)/sum(antall)) %>% 
  ungroup() %>% 
  mutate(ISCO1=isco_labels[ISCO1]) %>% 
  gt() %>% 
  tab_spanner(
    columns = vars(antall, remote_antall),
    label="Number of jobs"
  ) %>% 
  cols_label(ISCO1 = "Occupational Group",
             antall = "Total",
             remote_antall = "Remote-friendly",
             remote_pct = "Percent remote friendly"
             ) %>% 
  summary_rows(
    columns = vars(antall, remote_antall),
    fns = list(Sum = ~ sum(.))
  ) %>% 
  fmt_percent(columns=vars(remote_pct), decimals = 1, dec_mark = ",") #%>% 
  #fmt(columns=vars(remote_antall, antall), fns=custfmt)
  

```

For each broad occupational group, the share of jobs that can be performed remotely varies from 0 to 67 per cent. Academics and managers are both groups where more than half of the employees can be done remotely, but an even higher share of clerical support workers are likely able to do their jobs from home.

This bears strong resemblance to the table comparing the relative percentages of ads and annotations, but now with absolute numbers. Managers and academics do indeed often have jobs that can be performed from home, but this is even more the case for clerical support workers where two thirds theoretically could be working from home.


The geographic location of jobs have been a point of interest for years, amid both pressure for workers to centralize and specialize, and fears of increased inequality between cities and rural areas. Cities have a higher share of remote-friendly jobs, which may be fortunate given the need for social distancing.

```{r, echo=FALSE}

nor = read_rds('data/gadm36_NOR_2_sf.rds')

yrke_kommune <- read_csv('data/yrke_kommuner.csv')
names(yrke_kommune) <- c('region', 'kjonn', 'alder', 'yrke', 'antall')

yrke_kommune %>% 
  mutate(kommnavn = str_extract(region, '[A-zøæåØÆÅ-]+'),
         kommnr = substr(region, 1, 4),
         ISCO1 = substr(yrke, 1, 1)) %>% 
  mutate(kommnavn = case_when(
    kommnr == '0528' ~ 'Østre Toten',
    kommnr == '0529' ~ 'Vestre Toten',
    kommnr == '0536' ~ 'Søndre Land',
    kommnr == '0538' ~ 'Nordre Land',
    kommnr == '0543' ~ 'Vestre Slidre',
    kommnr == '0544' ~ 'Øystre Slidre',
    kommnr == '0624' ~ 'Øvre Eiker',
    kommnr == '0625' ~ 'Nedre Eiker',
    kommnr == '0633' ~ 'Nore og Uvdal',
    kommnr == '0701' ~ 'Horten',
    kommnr == '0716' ~ 'Re',
    kommnr == '0729' ~ 'Færder',
    kommnr == '1850' ~ 'Tysfjord',
    kommnr == '1920' ~ 'Lavangen',
    kommnr == '1940' ~ 'Kåfjord',
    kommnr == '2011' ~ 'Kautokeino',
    kommnr == '2021' ~ 'Karasjok',
    kommnr == '2025' ~ 'Tana',
    kommnr == '2027' ~ 'Nesseby',
    kommnr == '0729' ~ 'Færder',
    kommnr == '0729' ~ 'Færder',
    kommnr == '5027' ~ 'Midtre Gauldal',
    kommnr == '5040' ~ 'Namdalseid',
    kommnr == '5041' ~ 'Snåsa',
    kommnr == '5043' ~ 'Røyrvik',
    kommnr == '5054' ~ 'Indre Fosen',
    TRUE ~ kommnavn
  ))  -> yrke_kommune


syss_total %>% 
  group_by(ISCO1) %>% 
  summarize(remote_pct_isco1 = sum(remote_count)/sum(antall)) %>% 
  ungroup() %>% 
  left_join(yrke_kommune, by="ISCO1") %>% 
  mutate(remote_antall = antall*remote_pct_isco1) %>% 
  group_by(kommnavn, kommnr) %>% 
  summarize(antall = sum(antall), 
            remote_antall = sum(remote_antall), 
            remote_pct = 100*sum(remote_antall)/sum(antall)
            ) %>% 
  ungroup() -> syss_total_komm

wfh_map <- merge(nor, syss_total_komm, by.x="NAME_2", by.y="kommnavn", all.x=TRUE)

wfh_map %>% 
  ggplot() +
  geom_sf(aes(fill=remote_pct, color=remote_pct)) +
  labs(fill="Remote percent", color="Remote percent") +
  theme_bw()
  
  
```

The pattern looks clear, especially in the area surrounding Oslo but also the other cities like Bergen, Trondheim and Stavanger seems to stand out on the map.

By introducing a measure of urbanness, we can analyze the relationship more formally. We use population per square km as a proxy for urbanness.


We can see a clear correlation between "urbanness", or population pr km$^2$, and the availability of remote-friendly jobs.

```{r, message=FALSE}
areas <- read_csv('data/muni_density.csv')

names(areas) <- c('region', 'befolkning', 'areal', 'landareal', 'ppkm')

areas <- areas %>% 
  filter(str_detect(substr(region, 1, 4), '[0-9]{4}')==TRUE)


areas_isco <- areas %>% 
  filter(str_detect(substr(region, 1, 4), '[0-9]{4}')==TRUE) %>% 
  mutate(kommnr = substr(region, 1, 4)) %>% 
inner_join(syss_total_komm, by=c('kommnr')) 


areas_isco %>% 
  ggplot(aes(ppkm, remote_pct)) +
  geom_point() +
  geom_smooth(method='lm', message=FALSE) + 
  scale_x_log10() +
  scale_y_log10() +
  labs(x="Population pr square km", y="Percent of workers with remote-friendly jobs")

```


In the simple linear model we have fitted, Person pr km$^2$ is clearly significant.

```{r}
m <- lm(remote_pct ~ ppkm, data=areas_isco)

tidy(m) %>%
  gt() %>% 
  fmt_number(columns = vars(p.value), decimals = 4)
```


## Similar work

The norwegian labor force survey has asked about remote-possibilities, covered in a report by FAFO [@FAFO:HK]. The question was wether the respondent had the opportunity to work from home at times, which is not to say that the job could be performed remotely in its entirety, and neither to say that those who weren't given the opportunity couldn't have worked from home if they had the option.

Nevertheless the results from this survey was broadly similar to these. In the survey, 71 per cent of managers responded that they had opportunity to work from home at times, much higher than the results here. This difference is likely attributable to the distinction mentioned above: Being able to perform *some* part of your job remotely does not mean that the job can be performed *primarily* remotely.

A recent working paper [NBER:1] explores the same question by using the O\*net ontology - an approach which directly inspired this paper. Also here, the findings are generally similar, even though the paper is based on US data. The O\*net ontology is empirically derived, lending it credibility. It is also very rich in how it describes occupations and their content.


## Further work

The sudden question of remote work highlights the need to expand our knowledge of occupations and their contents. For National Statistical Institutions in Europe, the most natural option would be to expand the existing ESCO ontology with this data. The results we have found also suggest that alternative approaches to collecting such information is feasible.








